<html><head>
<title>萬年曆國(農)曆查天干地支相關文章：聖嚴法師108自在語(一)</title>
<meta http-equiv="Content-Type" content="text/html; charset=big5">

<script language="JavaScript">
<!--
var SND =Array("為為善惡在一念間、修修福慧於方寸中。","星星之火足以燎原、小小善願能救世界。","天地有作育大德、我豈無慈悲宏願。",
"救度眾生是提起、不住著相是放下。","漫天紅塵心勿染、遍地荊棘杖竹行。",
"慈悲必春風化雨、智慧當日光普照。","悲善拔苦慈予樂、智火滅罪慧斷惑。","有大智慧有大願、無量福德無量壽。",
"若見心中如來藏、三界火宅化紅蓮。","應無所住而生其心、是入慈悲門。",
"道心之中有施無畏。","放下萬緣時、眾生一肩挑。",
"安寧身心靈、安定家與業。","南山老松早已衰老、北斗壽星尚甚年輕。",
"神龍潛藏深潭大澤、猛虎高臥危崖險窟。","佛法無他、只有壹味、自利利人的解脫味也。",
"常念觀音菩薩、心安就有平安。","朝山禮拜來修行、祈福消災願易成；口唱耳聽心恭敬、三步一拜向前行；身心舒暢好感應、業消障除福慧增。",
"一乞食千家飯、孤僧杖竹萬里遊；隨緣應化莫擁有、緣畢放身撒兩手。","放下不等放棄、是為脫困、是為提起；要能放下才能提起、提放自如是自在人。",
"遇事正面解讀逆向思考、成事確立方向鍥而不捨。","路遇懸崖峭壁走過去、巧過人間仙境莫逗留。",
"權勢財富屬社會共享、禍福苦樂乃各人因緣。","誘以名利權位不動心、陷於千軍萬馬無所懼。",
"天不錯地不錯是心錯、他有理你有理我沒理。","莫怨孝子賢孫何其少、但問養育兒女怎麼教。",
"學問的領域重在研究、經驗的範疇則為實踐。","漫漫長夜無夢春宵短、茫茫苦海有船彼岸近。",
"倚般若杵碎萬千障礙、運福德斧建人間淨土。","駕行般若船苦海普渡、常登涅槃山心性不動。",
"河山猶在、景物遷移；日月長運、人事全非。","天上人間樂與苦、自心造作自身受。",
"青山綠水廣長舌、鳥語花香說妙法。","教育為千秋大業、賢能乃百代楷模。",
"水深千丈終見底、山高萬里海中昇。","雲門日日是好日、行腳步步履芳草。",
"世間本無垢與淨、祇緣自起分別心。","夕陽西下明天見、旭日東昇近黃昏。",
"戲外看戲忘了戲、夢中作夢不知夢。","雨露霜雪本無主、風雲雷電應時現。",
"危機化為轉機時、絕路走出活路人。","天堂地獄由心造、成佛作祖心外無。",
"驚覺執迷已近悟、知迷不悟錯中錯。","人生若夢誰都會說、終生作夢怎麼不醒。",
"百千計畫忙碌一生、萬緣放下前程似錦。","臨渴掘井緩不濟急、即時學佛即時解惑。",
"勿因有事而憂、寧為無事而喜。","禪法即是心法、萬法由心生滅。",
"大夢誰先覺、離夢想顛倒。","人上有人、山高水長。",
"走路健康鍊身、更可修行鍊心、快走驅遣妄情、慢走發慧習定。","月缺月圓日、若晦若明時；風雨無月夜、月亮本常明。",
"世俗境：身如玉樹臨風、心如平湖秋月。","修行境：身是菩提樹、心如明鏡臺。",
"悟後境：菩提本無樹、明鏡亦非臺。","有相無相有無相、真空假空真假空。",
"交友應交直諒多聞、信佛當避怪力亂神、學法幸勿到處摸門、敬僧切忌盲從個人。","多福少福當培福、知恩念恩必報恩。",
"慈悲心化解怨敵、智慧心驅除煩惱。","恭敬心護持三寶、清淨心弘法利生。",
"感恩心體驗生活、精進心善用生命。","慚愧心增長福德、懺悔心消滅罪障。",
"懷恩報恩恩相續、飲水思源源不絕。","堅韌心易度難關、長遠心可成大事。",
"你心我心同佛心、知福惜福多培福。","涓滴之恩湧泉以饋、一飯之施粉身相報。",
"取水飲水以水飲人、受恩謝恩用恩謝人。","解開愛恨情仇心結、學習慈悲喜捨心量。",
"父母之恩重於天地、三寶之德多過恆沙。","知恩報恩是飲水思源、恩情糾結會相互傷害。",
"感恩是終生受用的福報、懷恨乃永世糾纏的魔障。","若不善用財富利益世人、便像錦衣夜行暗自驕矜。",
"布施是經營財富的價值、種福乃過手財富的原因。","家業百年不墜因為積福、富貴不過三代由於自私。",
"隨時服務他人、終生幸福；有力不結善緣、後悔莫及。","看天播種時、耘草施肥日、豐收感恩月、祈求年年好年。",
"人生所求四大美事為：求福當先種福、培福、惜福；求祿當先廣結善緣；求壽當常保健；求喜先應笑面迎人。","以慚愧心反觀自己、時時覺得於己於人總是努力不足奉獻不夠。",
"以慚愧心觀照本身為人、做人若不自我省察檢點邪正、隨時有失足之危。","用感恩心看待世界事物、做人若不感恩圖報以奉獻世界、活水便會枯竭。",
"百年相守、相互尊敬感恩、相互學習所長、相互原諒缺失、相互關愛扶持。","真誠必有應、精勤萬事成。",
"寧以勤勉補笨拙、勿仗聰明而懈怠。","嚴以律己不虧損、寬以待人受益多。",
"守貧望富當勤儉、處亂守安不動心。","菜根清香布衣暖、勤勞健康節儉富。",
"及時行樂乃浪漫、隨處修善積功德。","能中更有能中手、各自努力莫羨人。",
"聽諍言未必順耳、嚐苦味的是良藥。","枯旱祈降及時雨、隆冬願作送暖人。",
"鳳凰好棲富貴宅、白鶴喜落福壽家。","心中不存得失想、常作世間無事人。",
"才德兼備是賢良、有能無德害群馬。","知過即改不為恥、放下屠刀立成佛。",
"警惕富貴不出三代、小心權勢令人墮落。","自古將相多出寒門、捨己為公天下太平。",
"少些人我是非的執著、多點成人之美的言行。","若望常保富貴、培福要緊、富貴多從積福來。",
"受持觀世音菩薩名號、得無量無邊福德之利。","爭奪他人飯碗莫如自家耕田、自家無田可耕幫人耕田也好。",
"常喫謙虛恭敬恕忍寬厚的飯、多喝誠實禮讓勤勞節儉之湯。","一夜致富是暴富、一夕成名乃虛名、暴富暴發富難守、虛名不實名累人。",
"知音難遇正常事、勿因孤獨不理人；少煩少惱福德長、多思多慮障礙增。","多心防人易遭鬼、知己知彼逢貴人、富貴貧賤皆布施、自利利人利眾生。",
"人生在世、當備四得：生得其所、老得其福、病得健康、死得其時、萬千幸福在其中矣。","富貴未必只三代、賢哲未必生於寒門；富貴當積德、寒門須勤勉。",
"行善沒有條件。","珍惜生命、為自己加油。");

var LunData=new Array(
"h0A4D0","h0D250","h1D295","h0B550","h056A0","h0ADA2","h095B0","h14977","h049B0","h0A4B0",
"h0B4B5","h06A50","h06D40","h1AB54","h02B60","h09570","h052F2","h04970","h06566","h0D4A0",
"h0EA50","h16A95","h05AD0","h02B60","h186E3","h092E0","h1C8D7","h0C950","h0D4A0","h1D8A6",
"h0B550","h056A0","h1A5B4","h025D0","h092D0","h0D2B2","h0A950","h0B557","h06CA0","h0B550",
"h15355","h04DA0","h0A5B0","h14573","h052B0","h0A9A8","h0E950","h06AA0","h0AEA6","h0AB50",
"h04B60","h0AAE4","h0A570","h05260","h0F263","h0D950","h05B57","h056A0","h096D0","h04DD5",
"h04AD0","h0A4D0","h0D4D4","h0D250","h0D558","h0B540","h0B6A0","h195A6","h095B0","h049B0",
"h0A974","h0A4B0","h0B27A","h06A50","h06D40","h0AF46","h0AB60","h09570","h04AF5","h04970",
"h064B0","h074A3","h0EA50","h06B58","h05AC0","h0AB60","h096D5","h092E0","h0C960","h0D954",
"h0D4A0","h0DA50","h07552","h056A0","h0ABB7","h025D0","h092D0","h0CAB5","h0A950","h0B4A0",
"h0BAA4","h0AD50","h055D9","h04BA0","h0A5B0","h15176","h052B0","h06930","h07954","h06AA0",
"h0AD50","h05B52","h04B60","h0A6E6","h0A4E0","h0D260","h0EA65","h0D520","h0DAA0","h076A3",
"h096D0","h04AFB","h04AD0","h0A4D0","h1D0B6","h0D250","h0D520","h0DD45","h0B5A0","h056D0",
"h055B2","h049B0","h0A577","h0A4B0","h0AA50","h1B255","h06D20","h0ADA0","h14B63","h09370",
"h049F8","h04970","h064B0","h168A6","h0EA50","h06B20","h1A6C4","h0AAE0","h092E0","h0D2E3",
"h0C960","h0D557","h0D4A0","h0DA50","h05D55","h056A0","h0A6D0","h055D4","h052D0","h0A9B8");

var Today = new Date();
var Ny = Today.getFullYear();
var Nm = Today.getMonth();
var Nd = Today.getDate();
var cld,Selday;
var NHoliday = new Array(
"0101*元旦", "0111 司法節","0115 藥師節","0123 自由日","0204 農民節","0214 情人節",
"0215 戲劇節","0219 新生活運動紀念日","0228*和平紀念日","0301 兵役節","0305 童子軍節",
"0308 婦女節","0312 植樹節","0317 國醫節","0320 郵政節","0321 氣象節","0325 美術節",
"0326 廣播節","0329 青年節","0330 出版節","0401 愚人節","0404 婦幼節","0405 音樂節",
"0407 衛生節","0422 世界地球日","0501*勞動節","0504 文藝節","0505 舞蹈節","0510 珠算節",
"0512 護士節","0603 禁煙節","0606 工程師節","0609 鐵路節","0615 警察節","0630 會計師節",
"0701 漁民節","0711 航海節","0712 聾啞節","0808 父親節","0814 空軍節","0827 鄭成功誕辰",
"0901 記者節","0903 軍人節","0909 體育節","0913 法律日","0928 教師節","1006 老人節",
"1010*國慶紀念日","1021 華僑節","1025 台灣光復節","1031 萬聖節","1101 商人節","1111 工業節",
"1117 自來水節","1112 國父誕辰日","1121 防空節","1205 海員節","1210 人權節","1212 憲兵節",
"1225 行憲紀念日","1227 建築師節","1228 電信節","1231 受信節");
var WHoliday = new Array(
"0520 母親節","0716 合作節","0730 被奴役國家週","1144 感恩節");
var LHoliday = new Array(
"0101*春節","0102*回娘家","0103*祭祖","0104 迎神","0105 開市","0109 天公生","0115 元宵節","0202 頭牙",
"0323 媽祖生","0408 浴佛節","0505*端午節","0701 開鬼門","0707 七夕情人節","0715 中元節","0800 關鬼門",
"0815*中秋節","0909 重陽節","1208 臘八節","1216 尾牙","1224 送神","0100*除夕");

function initialize() {

 var Today = new Date();
var Ny = Today.getFullYear();
var Nm = Today.getMonth();
var Nd = Today.getDate();

 CLD.SY.selectedIndex=Ny-1912;
 CLD.SM.selectedIndex=Nm;
 drawCld(Ny,Nm);
}
var NMonthDays=new Array(31,28,31,30,31,30,31,31,30,31,30,31);
function isLeapYear(y,m) {
 if(m==1)
    return(((y%4 == 0) && (y%100 != 0) || (y%400 == 0))? 29: 28);
 else
    return(NMonthDays[m]);
}

function lYearDays(y) {
var i,k, sum = 0; 
  k=StrToInt(y,5);
  for(i=1;i<13;i++) sum += (k & (0x10000>>i))? 30 : 29;
   return(sum+leapDays(y));
}

function leapDays(y) {
  if(leapMonth(y)) return( (StrToInt(y,1)&0xf)? 30: 29);
  else return(0);
}

function leapMonth(y) {
 return(StrToInt(y,5) & 0xf);
}

function LmonthDays(y,m) {
  return( (StrToInt(y,5) & (0x10000>>m))? 30: 29 );
}

function StrToInt(yx,vx){
 var sr;
  sr=LunData[yx-1912];
   sr=sr.substr(1, vx);
   return (parseInt('0x'+sr));
}

function Lunar(objDate) {
 var i, leap=0, temp=0;
 var offset = (Date.UTC(objDate.getFullYear(),objDate.getMonth(),
                        objDate.getDate()) - Date.UTC(1912,1,18))/86400000;
 for(i=1912; i<2072 && offset>0; i++) { temp=lYearDays(i); offset-=temp; }
  if(offset<0) { offset+=temp; i--; }
   this.year = i;
  leap = leapMonth(i); 
  this.isLeap = false;
 for(i=1; i<13 && offset>0; i++) {
   if(leap>0 && i==(leap+1) && this.isLeap==false)
     { --i; this.isLeap = true; temp = leapDays(this.year); }
   else
    { temp = LmonthDays(this.year, i); }
     if(this.isLeap==true && i==(leap+1)) this.isLeap = false;
     offset -= temp;
 }

 if(offset==0 && leap>0 && i==leap+1)
    if(this.isLeap)
       { this.isLeap = false; }
    else
       { this.isLeap = true; --i; }
  if(offset<0){ offset += temp; --i; }
   this.month = i;
   this.day = offset + 1;
}
var Gan=new Array("甲","乙","丙","丁","戊","己","庚","辛","壬","癸");
var Zhi=new Array("子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥");
function GanZhi(num) {
 return(Gan[num%10]+Zhi[num%12]);
}


function calElement(sYear,sMonth,sDay,week,lYear,lMonth,lDay,isLeap,cYear,cMonth,jMonth,cDay) {
  this.isToday    = false;
  this.sYear      = sYear;   
   this.sMonth     = sMonth; 
    this.sDay       = sDay;  
     this.week       = week; 
  this.lYear      = lYear;   
   this.lMonth     = lMonth; 
    this.lDay       = lDay;  
     this.isLeap     = isLeap; 
  this.cYear      = cYear;   
   this.cMonth     = cMonth; 
    this.jMonth     = jMonth;
     this.cDay       = cDay; 
     this.color      = '';
  this.Lholiday = ''; 
   this.Nholiday = ''; 
    this.solarTerms    = '';
}
var TermData = new Array(0,21324,42505,63868,85407,107110,128977,151002,173218,195611,218134,240768,263418,286062,308631,331096,353423,375568,397546,419292,440895,462344,483626,504891);
function sTerm(y,n) {
 var offDate = new Date( ( 31556925974.7*(y-1912) + TermData[n]*60000  ) + Date.UTC(1912,0,7,0,7) );
 return(offDate.getUTCDate());
}
var SolarTerm = new Array("小寒","大寒","立春","雨水","驚蟄","春分","清明","穀雨","立夏","小滿","芒種","夏至","小暑","大暑","立秋","處暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至");
var dStr1 = new Array('日','一','二','三','四','五','六','七','八','九','十');
function calendar(y,m) {
 var sDObj, lDObj, Ly, Lm, Ld=1, Lp, Lx=0, tmp1, tmp2, tmp3;
 var Cy, Cm, Jm, Cd; 
 var Ldpos = new Array(3);
 var n = 0;
 var firstLM = 0;
 sDObj = new Date(y,m,1,0,0,0,0); 
 this.length    = isLeapYear(y,m);
 this.firstWeek = sDObj.getDay(); 
  if(m<2)  Cy=GanZhi(y-1912+47); 
 else Cy=GanZhi(y-1912+48);
 var term2=sTerm(y,2);
 var firstNode = sTerm(y,m*2);
 //Jm = GanZhi((y-1912)*12+m+36);
 Cm = GanZhi((y-1912)*12+m+36);
 var dayCyclical = Date.UTC(y,m,1,0,0,0,0)/86400000+21185+12;
 
 for(var i=0;i<this.length;i++) {
    if(Ld>Lx) {
       sDObj = new Date(y,m,i+1);
       lDObj = new Lunar(sDObj);
       Ly    = lDObj.year;
       Lm    = lDObj.month;
       Ld    = lDObj.day;
       Lp    = lDObj.isLeap;
       Lx    = Lp? leapDays(Ly): LmonthDays(Ly,Lm);
       if(n==0)  firstLM = Lm;
       Ldpos[n++] = i-Ld+1;
    }

    if(m==1 && (i+1)==term2) Cy=GanZhi(y-1912+48);
     if((i+1)==firstNode) //Jm = GanZhi((y-1912)*12+m+37);
	//Cm= GanZhi((Ly-1912)*12+Lm+37);
	Cm = GanZhi((y-1912)*12+m+37);
    Cd = GanZhi(dayCyclical+i);
    this[i] = new calElement(y,m+1,i+1,dStr1[(i+this.firstWeek)%7],
	                        Ly,Lm,Ld++,Lp,Cy,Cm,Jm,Cd );
 }

  tmp1=sTerm(y,m*2  )-1;
   tmp2=sTerm(y,m*2+1)-1;
 this[tmp1].solarTerms = SolarTerm[m*2];
  this[tmp2].solarTerms = SolarTerm[m*2+1];
   if(m==3) this[tmp1].color = 'red';

 for(i in NHoliday)
  if(NHoliday[i].match(/^(\d{2})(\d{2})([\s\*])(.+)$/))
   if(Number(RegExp.$1)==(m+1)) {
    if(Number(RegExp.$2)<=this.length){
     this[Number(RegExp.$2)-1].Nholiday += RegExp.$4 + ' ';
      if(RegExp.$3=='*') this[Number(RegExp.$2)-1].color = 'red';
       }
     }
 for(i in WHoliday)
  if(WHoliday[i].match(/^(\d{2})(\d)(\d)([\s\*])(.+)$/))
   if(Number(RegExp.$1)==(m+1)) {
    tmp1=Number(RegExp.$2);
     tmp2=Number(RegExp.$3);
      if(tmp1<5)
       this[((this.firstWeek>tmp2)?7:0) + 7*(tmp1-1) + tmp2 - this.firstWeek].Nholiday += RegExp.$5 + ' ';
      else {
       tmp1 -= 5;
        tmp3 = (this.firstWeek+this.length-1)%7;
         this[this.length - tmp3 - 7*tmp1 + tmp2 - (tmp2>tmp3?7:0) - 1 ].Nholiday += RegExp.$5 + ' ';
         }
       }
 for(i in LHoliday)
  if(LHoliday[i].match(/^(\d{2})(.{2})([\s\*])(.+)$/)) {
    tmp1=Number(RegExp.$1)-firstLM;
     if(tmp1==-11) tmp1=1;
      if(tmp1 >=0 && tmp1<n) {
       tmp2 = Ldpos[tmp1] + Number(RegExp.$2) -1;
        if( tmp2 >= 0 && tmp2<this.length && this[tmp2].isLeap!=true) {
         this[tmp2].Lholiday += RegExp.$4 + ' ';
          if(RegExp.$3=='*') this[tmp2].color = 'red';
         }
       }
    }
 if(m==2 || m==3) {
  var estDay = new easter(y);
   if(m == estDay.m)
    this[estDay.d-1].Nholiday = this[estDay.d-1].Nholiday+'復活節';
 }
 if((this.firstWeek+12)%7==5) this[12].Nholiday += '黑色星期五';
 if(y==Ny && m==Nm) {
  this[Nd-1].isToday = true;
   this[Nd-1].color ='#ff00ff';
 }
}

function easter(y) {
 var term2=sTerm(y,5);
 var dayTerm2 = new Date(Date.UTC(y,2,term2,0,0,0,0)); 
 var lDayTerm2 = new Lunar(dayTerm2);

 if(lDayTerm2.day<15)
   var Lmlen= 15-lDayTerm2.day;
 else
   var Lmlen= (lDayTerm2.isLeap? leapDays(y): LmonthDays(y,lDayTerm2.month)) - lDayTerm2.day + 15;
 var NextMoon = new Date(dayTerm2.getTime() + 86400000*Lmlen );
  var dayEaster = new Date(NextMoon.getTime() + 86400000*( 7-NextMoon.getUTCDay()));
  this.m = dayEaster.getUTCMonth();
  this.d = dayEaster.getUTCDate();
}
var dStr2 = new Array('初','十','廿','卅','卌');
function cDay(d){
 var s;
 switch (d) {
    case 10:
       s = '初十'; break;
    case 20:
       s = '二十'; break;
    case 30:
       s = '三十'; break;
    default :
       s = dStr2[Math.floor(d/10)];
       s += dStr1[d%10];
 }
 return(s);
}
var Zodiac=new Array("鼠","牛","虎","兔","龍","蛇","馬","羊","猴","雞","狗","豬");
function drawCld(SY,SM) {
 var i,sD,s,size,Lastday;
 cld = new calendar(SY,SM);
 Lastday=isLeapYear(SY,SM);
  if (Selday> Lastday) Selday= Lastday;
 for(i=0;i<42;i++) {
    nObj=eval('SD'+ i);
    lObj=eval('LD'+ i);
	zObj=eval('DZ'+ i);
    nObj.style.cursor = 'hand'
    nObj.className = '';
   sD = i - cld.firstWeek;
    if(sD>-1 && sD<cld.length) {
      nObj.innerHTML = sD+1;
    if(cld[sD].isToday) Selday=sD+1;
    if (Selday==(i-cld.firstWeek+1)){
       mCls();
     if(cld[sD].lYear>1911) yDisplay = '民國' + (((cld[sD].lYear-1911)==1)?'元':cld[sD].lYear-1911);
	   Ldz.innerHTML ='　農曆:'+yDisplay+'年 '+(cld[sD].isLeap?'閏 ':' ')+cld[sD].lMonth+' 月 '+cld[sD].lDay+' 日';
	 	//Ldzx.innerHTML='　歲次：' +cld[sD].cYear+'年 '+cld[sD].cMonth+'('+cld[sD].jMonth+')'+'月 '+cld[sD].cDay + '日 生肖屬：【'+Zodiac[(cld[sD].lYear-4)%12]+'】';
    Ldzx.innerHTML='　歲次：' +cld[sD].cYear+'年 '+cld[sD].cMonth+'月 '+cld[sD].cDay + '日 生肖屬：【'+Zodiac[(cld[sD].lYear-4)%12]+'】';
    
   if(cld[sD].sYear>1911) yDisplay = '民國' + (((cld[sD].sYear-1911)==1)?'元':cld[sD].sYear-1911);
	  Ndz.innerHTML='　國曆:'+yDisplay+'年 '+cld[sD].sMonth+' 月 '+cld[sD].sDay+' 日';
	   CHSND.innerHTML='聖師言:'+SND[(cld[sD].sMonth-1)*9+(cld[sD].sDay)%8]; 
       nObj.className = 'MoveColor';
	  } 
    nObj.style.color = cld[sD].color; 
     if(cld[sD].lDay==1) 
	  if (cld[sD].isLeap) 
	   lObj.innerHTML = '<b>'+'閏'+ cld[sD].lMonth + '月' + (leapDays(cld[sD].lYear)==29?'小':'大')+'</b>'
	  else
       lObj.innerHTML = '<b>'+ cld[sD].lMonth + '月' + (LmonthDays(cld[sD].lYear,cld[sD].lMonth)==29?'小':'大')+'</b>';
      else 
       lObj.innerHTML = cDay(cld[sD].lDay);
	   zObj.innerHTML = cld[sD].cDay;   
      s=cld[sD].Lholiday;
       if(s.length>0) {
        if(s.length>6) s = s.substr(0, 5);
         s = s.fontcolor('red');
       }
     else {
      s=cld[sD].Nholiday;
       if(s.length>0) {
        size = (s.charCodeAt(0)>0 && s.charCodeAt(0)<128)?8:5;
         if(s.length>size+2) s = s.substr(0, size);
          s=(s=='黑色星期五')?s.fontcolor('black'):s.fontcolor('blue');
        }
    else {
     s=cld[sD].solarTerms;
      if(s.length>0) s = s.fontcolor('#cc00cc');
       }
     }
    if(cld[sD].solarTerms=='清明') s = '清明節'.fontcolor('red');
     if(s.length>0) zObj.innerHTML = s;
    }
   else { 
    nObj.innerHTML = '';
    lObj.innerHTML = '';
	zObj.innerHTML = '';
    }
  }
}

function changeCld() {
 var y,m;
 y=CLD.SY.selectedIndex+1912;
 m=CLD.SM.selectedIndex;
 drawCld(y,m);
}

function pushBtm(K) {
 switch (K){
   case 'YD' :
    if(CLD.SY.selectedIndex>0) CLD.SY.selectedIndex--;
     break;
   case 'YU' :
    if(CLD.SY.selectedIndex<159) CLD.SY.selectedIndex++;
     break;
   case 'MD' :
    if(CLD.SM.selectedIndex>0) {
     CLD.SM.selectedIndex--;
    }
   else {
    CLD.SM.selectedIndex=11;
    if(CLD.SY.selectedIndex>0) CLD.SY.selectedIndex--;
     }
     break;
   case 'MU' :
    if(CLD.SM.selectedIndex<11) {
     CLD.SM.selectedIndex++;
     }
   else {
    CLD.SM.selectedIndex=0;
    if(CLD.SY.selectedIndex<159) CLD.SY.selectedIndex++;
     }
    break;
     default :
     CLD.SY.selectedIndex=Ny-1912;
     CLD.SM.selectedIndex=Nm;
 }
  changeCld();
}

 //////////////////////////////////////

function mDown(v) {
 var s,ax;
 var nObj=eval('SD'+ v);
 var d=nObj.innerHTML-1;
 var  mObj=eval('SD'+ Selday);
  if(nObj.innerHTML!='') {
    mObj.className='';
	 mCls();
   if(cld[d].lYear>1911) yDisplay = '民國' + (((cld[d].lYear-1911)==1)?'元':cld[d].lYear-1911);
	 Ldz.innerHTML ='　農曆:'+yDisplay+'年 '+(cld[d].isLeap?'閏 ':' ')+cld[d].lMonth+' 月 '+cld[d].lDay+' 日';
	 //Ldzx.innerHTML='　歲次：' +cld[d].cYear+'年 '+cld[d].cMonth+'('+cld[d].jMonth+')'+'月 '+cld[d].cDay + '日 生肖屬：【'+Zodiac[(cld[d].lYear-4)%12]+'】';
   	 Ldzx.innerHTML='　歲次：' +cld[d].cYear+'年 '+cld[d].cMonth+'月 '+cld[d].cDay + '日 生肖屬：【'+Zodiac[(cld[d].lYear-4)%12]+'】';
   if(cld[d].sYear>1911) yDisplay = '民國' + (((cld[d].sYear-1911)==1)?'元':cld[d].sYear-1911);
	Ndz.innerHTML='　國曆:'+yDisplay+'年 '+cld[d].sMonth+' 月 '+cld[d].sDay+' 日';
    CHSND.innerHTML='聖師言:'+SND[(cld[d].sMonth-1)*9+(cld[d].sDay)%8]; 
    nObj.className='MoveColor';
    Selday=v-cld.firstWeek+1;
     //  alert("are you sure ?");
     // Response.Redirect ("Excer2-1.asp?"& "YKK="&cld[d].cYear& "&" & "TNUM=" & cld[d].cMonth & "&" & "DNUM=" & cld[d].cDay & "&" & "HNUM= 午") 
    
    s='　歲次：' +cld[d].cYear+'年 '+cld[d].cMonth+'('+cld[d].jMonth+')'+'月 '+cld[d].cDay + ' 日';

       } 
       
     }  
 
function GetZhi(s){
   s = s.substr(1, 1);
  for(i=0;i<12;i++)
   if(s==Zhi[i]) return(i);
}	

function mCls() {
 for(i=0;i<42;i++) {
    mObj=eval('SD'+ i);
	 mObj.className='';
  }	 
 }  
//-->
</script>
 
 </HEAD> 
   <style>.MoveColor {
        			BACKGROUND-COLOR: aqua;
					}
	</style>
<body bgcolor= #99FFCC text="#000000" onload=initialize() >
 <!--<body  text="#000000" onload=initialize() >-->
<div align="center"> 
  
 <!-- <table border=0 cellpadding=0 cellspacing=0 width=590 height="327">-->
    
          <form name="CLD">
                 <div >
                      <tr bgcolor= #0000FF >
                       <td ><FONT color="#ff00ff" id=CHSND size=5>
                        </FONT></td></tr>
                 </div>
                <div align="center"> 
                  <table width="560" align="center" border="0" >
                     <tbody> 
                      
                      
                      
                    <tr  align="center"  valign="top"> 
                      <td colspan=7 height="18"><font color=#0000ff size=3 
            style="FONT-SIZE: 12pt"> </font> 
                        <table width="465" border="0" height="15" align="center" >
                          <tr> 
                            <td align="center" bgcolor="#000080" height="15" width="460" valign="top" bordercolor="#333333"><font  size=3 
                        style="FONT-SIZE: 11pt"> 
                              <input type="button" name="Ybta"onClick="pushBtm('YD')" value="▼">
                              <select name=SY onChange=changeCld() 
                      style="FONT-SIZE: 11pt">
                                <script language=JavaScript><!--
           for(i=1912;i<2072;i++) 
 		   document.write('<option>'+i+'(民國'+((i-1911)==1?'元':(i-1911))+')');
		            //--></script>
                              </select>
                              <font size=3 style="FONT-SIZE: 12pt"> 
                              <input type="button" name="Ybtd" onClick="pushBtm('YU')" value="▲">
                              </font><font size="3" >年</font> 
                              <input type="button" name="Mbta"onClick="pushBtm('MD')" value="▼">
                              <select name=SM onChange=changeCld() 
            style="FONT-SIZE: 11pt">
                                <script language=JavaScript><!--
          for(i=1;i<13;i++) document.write('<option>'+i)
          //--></script>
                              </select>
                              <input type="button" name="Mbtd" onClick="pushBtm('MU')" value="▲">
                              <font size="3">月</font> 
                              <input type="button" name="Today" onClick="pushBtm('')" value="今天">
                              </font>
                            </td>
                          </tr>
                         </table>
                        <div align="center" ><FONT color="#ff00ff" id=Ndz size=3></FONT> 
                          <FONT color=#ff00ff id=Ldz size=3></FONT> <br>
                          <FONT color=#ffooff id=Ldzx size=3></FONT> </div>
                      
                    <tr align=center bgcolor="#00FFFF" > 
                      <td width=60 height="19"><b><font color="#FF0000">星期日</font></b></td>
                      <td width=60 height="19"><b>星期一</b></td>
                      <td width=60 height="19"><b>星期二</b></td>
                      <td width=60 height="19"><b>星期三</b></td>
                      <td width=60 height="19"><b>星期四</b></td>
                      <td width=60 height="19"><b>星期五</b></td>
                      <td width=60 height="19"><b><font color="#FF0000">星期六</font></b></td>
                    </tr>
                    <script language=JavaScript><!--
          var gDay;
          for(i=0;i<6;i++) {
             document.write('<tr align=center>')
             for(j=0;j<7;j++) {
                gDay = i*7+j
				 document.write('<td id="GD' + gDay +'" onMouseDown="mDown(' + gDay +')"><font id="SD' + gDay +'" size=5 face="Arial Black"');
                if((j == 0) || (j == 6) ) document.write(' color=red');
              document.write(' TITLE=""></font><br><font id="LD' + gDay + '"size=3 style="font-size:10pt"> ')
        		document.write(' </font><br><font id="DZ' + gDay + '"size=3 style="font-size:10pt"> </font></td>')
		     }
             document.write('</tr>')
          }
          //--></script>
             
             </td>
          </tr>
        </table>
          </tbody> 

        </form>
     </div>
</body>
</html>
